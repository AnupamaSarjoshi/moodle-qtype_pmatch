{"version":3,"file":"formchanged.min.js","sources":["../src/formchanged.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle. If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This file exists to work-around a limitation in formslib.\n *\n * See the comment in init below for more information.\n *\n * @module    qtype_pmatch\n * @class     formchanged\n * @copyright 2024 The Open University\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Watch the value change for element that using disableIf rule.\n *\n * @param {String} fieldNamePrefix prefix of the field name.\n */\nexport const init = (fieldNamePrefix) => {\n    // Spellcheck feature is not enabled if the hidden field is not exist.\n    if (!document.querySelector('[name=\"' + fieldNamePrefix + 'applydictionarycheckselectedvalue\"]')) {\n        return;\n    }\n    // Moodle formslib handles disables form fields in a way that is not helpful.\n    // With HTML, hidden fields are not sent back to the server in the HTML request,\n    // but in this case, formslib replaces the missing value with with the current\n    // value of that field from set_data when the form was created. So, there is\n    // no good way to determine which fields in the form were disabled.\n    //\n    // To work around this, this JS modules copies the current value of certain key fields\n    // into hidden fields, so they are always submitted when the form is saved.\n    document.querySelector('[name=\"' + fieldNamePrefix + 'applydictionarycheck\"]').addEventListener('change', function() {\n        document.querySelector('[name=\"' + fieldNamePrefix + 'applydictionarycheckselectedvalue\"]').value = this.value;\n    });\n\n    document.querySelector('[name=\"' + fieldNamePrefix + 'allowsubscript\"]').addEventListener('change', function() {\n        document.querySelector('[name=\"' + fieldNamePrefix + 'allowsubscriptselectedvalue\"]').value = this.value;\n    });\n\n    document.querySelector('[name=\"' + fieldNamePrefix + 'allowsuperscript\"]').addEventListener('change', function() {\n        document.querySelector('[name=\"' + fieldNamePrefix + 'allowsuperscriptselectedvalue\"]').value = this.value;\n    });\n};\n"],"names":["fieldNamePrefix","document","querySelector","addEventListener","value","this"],"mappings":"6JA+BqBA,kBAEZC,SAASC,cAAc,UAAYF,gBAAkB,yCAW1DC,SAASC,cAAc,UAAYF,gBAAkB,0BAA0BG,iBAAiB,UAAU,WACtGF,SAASC,cAAc,UAAYF,gBAAkB,uCAAuCI,MAAQC,KAAKD,SAG7GH,SAASC,cAAc,UAAYF,gBAAkB,oBAAoBG,iBAAiB,UAAU,WAChGF,SAASC,cAAc,UAAYF,gBAAkB,iCAAiCI,MAAQC,KAAKD,SAGvGH,SAASC,cAAc,UAAYF,gBAAkB,sBAAsBG,iBAAiB,UAAU,WAClGF,SAASC,cAAc,UAAYF,gBAAkB,mCAAmCI,MAAQC,KAAKD"}